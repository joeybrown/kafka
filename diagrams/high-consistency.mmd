sequenceDiagram
    participant P as Producer
    participant L as Leader Partition
    participant F1 as Follower 1
    participant F2 as Follower 2
    participant F3 as Follower 3

    Note over P,F3: High Consistency: Persist to Followers Before ACK

    P->>L: 1. Send Record (acks=all)
    Note over L: Leader receives record
    
    L->>F1: 2. Replicate to Follower 1
    L->>F2: 2. Replicate to Follower 2
    L->>F3: 2. Replicate to Follower 3
    
    Note over F1,F3: Followers persist to disk
    
    F1->>L: 3. ACK (persisted)
    F2->>L: 3. ACK (persisted)
    F3->>L: 3. ACK (persisted)
    
    Note over L: Leader waits for min.insync.replicas<br/>(default: 2 followers)
    
    L->>P: 4. ACK to Producer
    
    Note over P,F3: Record is durable and available<br/>even if leader fails
